<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Health Tracker</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
        }
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            padding: 4px;
            font-size: 12px;
        }
        .calendar-day-header {
            font-weight: 600;
            padding: 8px 4px;
            text-align: center;
            font-size: 12px;
        }
        .emoji-indicator {
            font-size: 16px;
            margin: 2px;
        }
        @media (min-width: 640px) {
            .calendar-day {
                font-size: 14px;
            }
            .emoji-indicator {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function HealthTrackerApp() {
            const [view, setView] = useState('daily'); // daily, weekly, monthly, summary, edit
            const [entries, setEntries] = useState({});
            const [currentDate, setCurrentDate] = useState(new Date());
            const [selectedDate, setSelectedDate] = useState(null); // For editing specific dates
            const [todayEntry, setTodayEntry] = useState({
                alcohol: '',
                steps: '',
                workout: false
            });

            // Load data from localStorage on mount
            useEffect(() => {
                const saved = localStorage.getItem('healthTrackerData');
                if (saved) {
                    setEntries(JSON.parse(saved));
                }
            }, []);

            // Save data to localStorage whenever entries change
            useEffect(() => {
                localStorage.setItem('healthTrackerData', JSON.stringify(entries));
            }, [entries]);

            // Load today's entry if it exists
            useEffect(() => {
                const todayKey = formatDate(new Date());
                if (entries[todayKey]) {
                    setTodayEntry(entries[todayKey]);
                }
            }, [entries]);

            function formatDate(date) {
                return date.toISOString().split('T')[0];
            }

            function getColor(type, value) {
                if (value === null || value === undefined || value === '') return 'bg-gray-200';

                switch(type) {
                    case 'alcohol':
                        const drinks = parseInt(value);
                        if (drinks >= 0 && drinks <= 2) return 'bg-green-400';
                        if (drinks >= 3 && drinks <= 4) return 'bg-yellow-400';
                        if (drinks >= 5) return 'bg-red-400';
                        return 'bg-gray-200';
                    case 'steps':
                        const steps = parseInt(value);
                        return steps >= 12500 ? 'bg-green-400' : 'bg-red-400';
                    case 'workout':
                        return value ? 'bg-green-400' : 'bg-red-400';
                    default:
                        return 'bg-gray-200';
                }
            }

            function saveEntry(date = null) {
                const dateKey = date ? formatDate(date) : formatDate(new Date());
                setEntries({
                    ...entries,
                    [dateKey]: {
                        alcohol: todayEntry.alcohol,
                        steps: todayEntry.steps,
                        workout: todayEntry.workout
                    }
                });
                // Return to the appropriate view
                if (view === 'edit') {
                    setView('daily');
                }
            }

            function editDate(date) {
                setSelectedDate(date);
                const dateKey = formatDate(date);
                const entry = entries[dateKey];
                if (entry) {
                    setTodayEntry({
                        alcohol: entry.alcohol,
                        steps: entry.steps,
                        workout: entry.workout
                    });
                } else {
                    setTodayEntry({
                        alcohol: '',
                        steps: '',
                        workout: false
                    });
                }
                setView('edit');
            }

            function handleInputChange(field, value) {
                setTodayEntry({
                    ...todayEntry,
                    [field]: value
                });
            }

            function EditView() {
                const dateKey = formatDate(selectedDate);
                const entry = todayEntry;

                return (
                    <div className="p-4 space-y-6">
                        <div className="flex items-center justify-between mb-6">
                            <button
                                onClick={() => {
                                    setView('daily');
                                    setSelectedDate(null);
                                }}
                                className="text-blue-600 font-semibold"
                            >
                                ‚Üê Back
                            </button>
                            <h2 className="text-xl font-bold">
                                {selectedDate.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}
                            </h2>
                            <div className="w-16"></div>
                        </div>

                        {/* Alcohol */}
                        <div className={`p-4 rounded-lg ${getColor('alcohol', entry.alcohol)}`}>
                            <div className="flex items-center mb-2">
                                <span className="text-3xl mr-3">üç∑</span>
                                <label className="text-lg font-semibold">Alcohol (drinks)</label>
                            </div>
                            <input
                                type="number"
                                min="0"
                                value={todayEntry.alcohol}
                                onChange={(e) => handleInputChange('alcohol', e.target.value)}
                                className="w-full p-3 text-lg border-2 border-gray-300 rounded"
                                placeholder="0"
                            />
                            <p className="mt-2 text-sm">
                                Green: 0-2 | Yellow: 3-4 | Red: 5+
                            </p>
                        </div>

                        {/* Steps */}
                        <div className={`p-4 rounded-lg ${getColor('steps', entry.steps)}`}>
                            <div className="flex items-center mb-2">
                                <span className="text-3xl mr-3">üëü</span>
                                <label className="text-lg font-semibold">Steps</label>
                            </div>
                            <input
                                type="number"
                                min="0"
                                value={todayEntry.steps}
                                onChange={(e) => handleInputChange('steps', e.target.value)}
                                className="w-full p-3 text-lg border-2 border-gray-300 rounded"
                                placeholder="0"
                            />
                            <p className="mt-2 text-sm">
                                Green: 12,500+ | Red: Less than 12,500
                            </p>
                        </div>

                        {/* Workout */}
                        <div className={`p-4 rounded-lg ${getColor('workout', entry.workout)}`}>
                            <div className="flex items-center mb-2">
                                <span className="text-3xl mr-3">üí™</span>
                                <label className="text-lg font-semibold">Workout</label>
                            </div>
                            <div className="flex gap-4">
                                <button
                                    onClick={() => handleInputChange('workout', true)}
                                    className={`flex-1 p-3 text-lg rounded border-2 ${
                                        todayEntry.workout
                                            ? 'bg-green-600 text-white border-green-700'
                                            : 'bg-white border-gray-300'
                                    }`}
                                >
                                    Yes ‚úì
                                </button>
                                <button
                                    onClick={() => handleInputChange('workout', false)}
                                    className={`flex-1 p-3 text-lg rounded border-2 ${
                                        !todayEntry.workout
                                            ? 'bg-red-600 text-white border-red-700'
                                            : 'bg-white border-gray-300'
                                    }`}
                                >
                                    No ‚úó
                                </button>
                            </div>
                            <p className="mt-2 text-sm">
                                Green: Yes | Red: No
                            </p>
                        </div>

                        <button
                            onClick={() => saveEntry(selectedDate)}
                            className="w-full bg-blue-600 text-white p-4 rounded-lg text-xl font-semibold hover:bg-blue-700"
                        >
                            Save Entry
                        </button>
                    </div>
                );
            }

            function DailyView() {
                const todayKey = formatDate(new Date());
                const entry = entries[todayKey] || todayEntry;

                return (
                    <div className="p-4 space-y-6">
                        <h2 className="text-2xl font-bold text-center mb-6">Today's Entry</h2>

                        {/* Alcohol */}
                        <div className={`p-4 rounded-lg ${getColor('alcohol', entry.alcohol)}`}>
                            <div className="flex items-center mb-2">
                                <span className="text-3xl mr-3">üç∑</span>
                                <label className="text-lg font-semibold">Alcohol (drinks)</label>
                            </div>
                            <input
                                type="number"
                                min="0"
                                value={todayEntry.alcohol}
                                onChange={(e) => handleInputChange('alcohol', e.target.value)}
                                className="w-full p-3 text-lg border-2 border-gray-300 rounded"
                                placeholder="0"
                            />
                            <p className="mt-2 text-sm">
                                Green: 0-2 | Yellow: 3-4 | Red: 5+
                            </p>
                        </div>

                        {/* Steps */}
                        <div className={`p-4 rounded-lg ${getColor('steps', entry.steps)}`}>
                            <div className="flex items-center mb-2">
                                <span className="text-3xl mr-3">üëü</span>
                                <label className="text-lg font-semibold">Steps</label>
                            </div>
                            <input
                                type="number"
                                min="0"
                                value={todayEntry.steps}
                                onChange={(e) => handleInputChange('steps', e.target.value)}
                                className="w-full p-3 text-lg border-2 border-gray-300 rounded"
                                placeholder="0"
                            />
                            <p className="mt-2 text-sm">
                                Green: 12,500+ | Red: Less than 12,500
                            </p>
                        </div>

                        {/* Workout */}
                        <div className={`p-4 rounded-lg ${getColor('workout', entry.workout)}`}>
                            <div className="flex items-center mb-2">
                                <span className="text-3xl mr-3">üí™</span>
                                <label className="text-lg font-semibold">Workout</label>
                            </div>
                            <div className="flex gap-4">
                                <button
                                    onClick={() => handleInputChange('workout', true)}
                                    className={`flex-1 p-3 text-lg rounded border-2 ${
                                        todayEntry.workout
                                            ? 'bg-green-600 text-white border-green-700'
                                            : 'bg-white border-gray-300'
                                    }`}
                                >
                                    Yes ‚úì
                                </button>
                                <button
                                    onClick={() => handleInputChange('workout', false)}
                                    className={`flex-1 p-3 text-lg rounded border-2 ${
                                        !todayEntry.workout
                                            ? 'bg-red-600 text-white border-red-700'
                                            : 'bg-white border-gray-300'
                                    }`}
                                >
                                    No ‚úó
                                </button>
                            </div>
                            <p className="mt-2 text-sm">
                                Green: Yes | Red: No
                            </p>
                        </div>

                        <button
                            onClick={saveEntry}
                            className="w-full bg-blue-600 text-white p-4 rounded-lg text-xl font-semibold hover:bg-blue-700"
                        >
                            Save Entry
                        </button>
                    </div>
                );
            }

            function WeeklyView() {
                const startOfWeek = new Date(currentDate);
                startOfWeek.setDate(currentDate.getDate() - currentDate.getDay());

                const days = [];
                for (let i = 0; i < 7; i++) {
                    const date = new Date(startOfWeek);
                    date.setDate(startOfWeek.getDate() + i);
                    days.push(date);
                }

                const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

                return (
                    <div className="p-4">
                        <div className="flex justify-between items-center mb-4">
                            <button
                                onClick={() => {
                                    const newDate = new Date(currentDate);
                                    newDate.setDate(currentDate.getDate() - 7);
                                    setCurrentDate(newDate);
                                }}
                                className="bg-blue-500 text-white px-4 py-2 rounded"
                            >
                                ‚Üê Prev
                            </button>
                            <h2 className="text-xl font-bold">
                                {startOfWeek.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })} -
                                {days[6].toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })}
                            </h2>
                            <button
                                onClick={() => {
                                    const newDate = new Date(currentDate);
                                    newDate.setDate(currentDate.getDate() + 7);
                                    setCurrentDate(newDate);
                                }}
                                className="bg-blue-500 text-white px-4 py-2 rounded"
                            >
                                Next ‚Üí
                            </button>
                        </div>

                        <div className="calendar-grid">
                            {days.map((date, idx) => {
                                const dateKey = formatDate(date);
                                const entry = entries[dateKey];
                                const isToday = formatDate(date) === formatDate(new Date());

                                return (
                                    <div key={idx} className="flex flex-col">
                                        <div className="calendar-day-header">
                                            {dayNames[idx]}
                                        </div>
                                        <button
                                            onClick={() => editDate(date)}
                                            className={`calendar-day bg-gray-100 hover:bg-gray-200 cursor-pointer ${isToday ? 'ring-2 ring-blue-500' : ''}`}
                                        >
                                            <div className="font-semibold">{date.getDate()}</div>
                                            {entry ? (
                                                <div className="flex flex-col gap-1 mt-1">
                                                    <div className={`emoji-indicator ${getColor('alcohol', entry.alcohol)} rounded px-1`}>
                                                        üç∑
                                                    </div>
                                                    <div className={`emoji-indicator ${getColor('steps', entry.steps)} rounded px-1`}>
                                                        üëü
                                                    </div>
                                                    <div className={`emoji-indicator ${getColor('workout', entry.workout)} rounded px-1`}>
                                                        üí™
                                                    </div>
                                                </div>
                                            ) : (
                                                <div className="text-gray-400 text-xs mt-1">No data</div>
                                            )}
                                        </button>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                );
            }

            function MonthlyView() {
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDay = firstDay.getDay();
                const daysInMonth = lastDay.getDate();

                const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                const monthName = currentDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });

                const weeks = [];
                let week = new Array(startDay).fill(null);

                for (let day = 1; day <= daysInMonth; day++) {
                    if (week.length === 7) {
                        weeks.push(week);
                        week = [];
                    }
                    week.push(day);
                }

                if (week.length > 0) {
                    while (week.length < 7) {
                        week.push(null);
                    }
                    weeks.push(week);
                }

                return (
                    <div className="p-4">
                        <div className="flex justify-between items-center mb-4">
                            <button
                                onClick={() => {
                                    const newDate = new Date(currentDate);
                                    newDate.setMonth(currentDate.getMonth() - 1);
                                    setCurrentDate(newDate);
                                }}
                                className="bg-blue-500 text-white px-4 py-2 rounded"
                            >
                                ‚Üê Prev
                            </button>
                            <h2 className="text-xl font-bold">{monthName}</h2>
                            <button
                                onClick={() => {
                                    const newDate = new Date(currentDate);
                                    newDate.setMonth(currentDate.getMonth() + 1);
                                    setCurrentDate(newDate);
                                }}
                                className="bg-blue-500 text-white px-4 py-2 rounded"
                            >
                                Next ‚Üí
                            </button>
                        </div>

                        <div className="calendar-grid mb-2">
                            {dayNames.map(name => (
                                <div key={name} className="calendar-day-header">{name}</div>
                            ))}
                        </div>

                        {weeks.map((week, weekIdx) => (
                            <div key={weekIdx} className="calendar-grid mb-1">
                                {week.map((day, dayIdx) => {
                                    if (!day) return <div key={dayIdx} className="calendar-day"></div>;

                                    const date = new Date(year, month, day);
                                    const dateKey = formatDate(date);
                                    const entry = entries[dateKey];
                                    const isToday = formatDate(date) === formatDate(new Date());

                                    return (
                                        <button
                                            key={dayIdx}
                                            onClick={() => editDate(date)}
                                            className={`calendar-day bg-gray-100 hover:bg-gray-200 cursor-pointer ${isToday ? 'ring-2 ring-blue-500' : ''}`}
                                        >
                                            <div className="font-semibold">{day}</div>
                                            {entry ? (
                                                <div className="flex gap-1 mt-1">
                                                    <span className={`text-xs ${getColor('alcohol', entry.alcohol)} rounded px-1`}>üç∑</span>
                                                    <span className={`text-xs ${getColor('steps', entry.steps)} rounded px-1`}>üëü</span>
                                                    <span className={`text-xs ${getColor('workout', entry.workout)} rounded px-1`}>üí™</span>
                                                </div>
                                            ) : (
                                                <div className="text-gray-400 text-xs mt-1">-</div>
                                            )}
                                        </button>
                                    );
                                })}
                            </div>
                        ))}
                    </div>
                );
            }

            function SummaryView() {
                const allDates = Object.keys(entries).sort().reverse();
                const last30Days = allDates.slice(0, 30);

                let alcoholGreen = 0, alcoholYellow = 0, alcoholRed = 0;
                let stepsGreen = 0, stepsRed = 0;
                let workoutYes = 0, workoutNo = 0;
                let currentStreak = 0;
                let longestStreak = 0;

                // Calculate stats
                last30Days.forEach(date => {
                    const entry = entries[date];

                    // Alcohol
                    const drinks = parseInt(entry.alcohol);
                    if (drinks >= 0 && drinks <= 2) alcoholGreen++;
                    else if (drinks >= 3 && drinks <= 4) alcoholYellow++;
                    else if (drinks >= 5) alcoholRed++;

                    // Steps
                    const steps = parseInt(entry.steps);
                    if (steps >= 12500) stepsGreen++;
                    else stepsRed++;

                    // Workout
                    if (entry.workout) workoutYes++;
                    else workoutNo++;
                });

                // Calculate workout streak
                const sortedDates = Object.keys(entries).sort().reverse();
                let streakCount = 0;

                for (let date of sortedDates) {
                    if (entries[date].workout) {
                        streakCount++;
                    } else {
                        if (streakCount > longestStreak) {
                            longestStreak = streakCount;
                        }
                        streakCount = 0;
                    }
                }
                if (streakCount > longestStreak) {
                    longestStreak = streakCount;
                }

                // Current streak from today backwards
                const today = formatDate(new Date());
                let checkDate = new Date();
                while (entries[formatDate(checkDate)] && entries[formatDate(checkDate)].workout) {
                    currentStreak++;
                    checkDate.setDate(checkDate.getDate() - 1);
                }

                return (
                    <div className="p-4 space-y-6">
                        <h2 className="text-2xl font-bold text-center mb-6">Summary (Last 30 Days)</h2>

                        {/* Alcohol Stats */}
                        <div className="bg-white p-4 rounded-lg shadow">
                            <div className="flex items-center mb-3">
                                <span className="text-3xl mr-3">üç∑</span>
                                <h3 className="text-xl font-bold">Alcohol Intake</h3>
                            </div>
                            <div className="space-y-2">
                                <div className="flex justify-between items-center">
                                    <span>Green (0-2 drinks)</span>
                                    <span className="bg-green-400 px-3 py-1 rounded font-bold">{alcoholGreen} days</span>
                                </div>
                                <div className="flex justify-between items-center">
                                    <span>Yellow (3-4 drinks)</span>
                                    <span className="bg-yellow-400 px-3 py-1 rounded font-bold">{alcoholYellow} days</span>
                                </div>
                                <div className="flex justify-between items-center">
                                    <span>Red (5+ drinks)</span>
                                    <span className="bg-red-400 px-3 py-1 rounded font-bold">{alcoholRed} days</span>
                                </div>
                            </div>
                        </div>

                        {/* Steps Stats */}
                        <div className="bg-white p-4 rounded-lg shadow">
                            <div className="flex items-center mb-3">
                                <span className="text-3xl mr-3">üëü</span>
                                <h3 className="text-xl font-bold">Step Goals</h3>
                            </div>
                            <div className="space-y-2">
                                <div className="flex justify-between items-center">
                                    <span>Goal Met (12,500+)</span>
                                    <span className="bg-green-400 px-3 py-1 rounded font-bold">{stepsGreen} days</span>
                                </div>
                                <div className="flex justify-between items-center">
                                    <span>Below Goal</span>
                                    <span className="bg-red-400 px-3 py-1 rounded font-bold">{stepsRed} days</span>
                                </div>
                                <div className="mt-2 pt-2 border-t">
                                    <span className="font-semibold">Success Rate: </span>
                                    <span className="text-lg font-bold">
                                        {stepsGreen + stepsRed > 0 ? Math.round((stepsGreen / (stepsGreen + stepsRed)) * 100) : 0}%
                                    </span>
                                </div>
                            </div>
                        </div>

                        {/* Workout Stats */}
                        <div className="bg-white p-4 rounded-lg shadow">
                            <div className="flex items-center mb-3">
                                <span className="text-3xl mr-3">üí™</span>
                                <h3 className="text-xl font-bold">Workouts</h3>
                            </div>
                            <div className="space-y-2">
                                <div className="flex justify-between items-center">
                                    <span>Completed</span>
                                    <span className="bg-green-400 px-3 py-1 rounded font-bold">{workoutYes} days</span>
                                </div>
                                <div className="flex justify-between items-center">
                                    <span>Missed</span>
                                    <span className="bg-red-400 px-3 py-1 rounded font-bold">{workoutNo} days</span>
                                </div>
                                <div className="mt-2 pt-2 border-t space-y-1">
                                    <div>
                                        <span className="font-semibold">Current Streak: </span>
                                        <span className="text-lg font-bold text-green-600">{currentStreak} days üî•</span>
                                    </div>
                                    <div>
                                        <span className="font-semibold">Longest Streak: </span>
                                        <span className="text-lg font-bold text-blue-600">{longestStreak} days üèÜ</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div className="text-center text-sm text-gray-600 mt-6">
                            Total entries logged: {allDates.length} days
                        </div>
                    </div>
                );
            }

            return (
                <div className="max-w-4xl mx-auto min-h-screen bg-gray-50">
                    {/* Header */}
                    <div className="bg-blue-600 text-white p-4 shadow-lg">
                        <h1 className="text-2xl font-bold text-center">Health Tracker</h1>
                    </div>

                    {/* Navigation */}
                    <div className="bg-white shadow-md sticky top-0 z-10">
                        <div className="flex">
                            <button
                                onClick={() => setView('daily')}
                                className={`flex-1 py-3 font-semibold ${
                                    view === 'daily'
                                        ? 'bg-blue-500 text-white'
                                        : 'bg-white text-gray-700 hover:bg-gray-100'
                                }`}
                            >
                                Daily
                            </button>
                            <button
                                onClick={() => setView('weekly')}
                                className={`flex-1 py-3 font-semibold ${
                                    view === 'weekly'
                                        ? 'bg-blue-500 text-white'
                                        : 'bg-white text-gray-700 hover:bg-gray-100'
                                }`}
                            >
                                Weekly
                            </button>
                            <button
                                onClick={() => setView('monthly')}
                                className={`flex-1 py-3 font-semibold ${
                                    view === 'monthly'
                                        ? 'bg-blue-500 text-white'
                                        : 'bg-white text-gray-700 hover:bg-gray-100'
                                }`}
                            >
                                Monthly
                            </button>
                            <button
                                onClick={() => setView('summary')}
                                className={`flex-1 py-3 font-semibold ${
                                    view === 'summary'
                                        ? 'bg-blue-500 text-white'
                                        : 'bg-white text-gray-700 hover:bg-gray-100'
                                }`}
                            >
                                Summary
                            </button>
                        </div>
                    </div>

                    {/* Content */}
                    <div className="pb-6">
                        {view === 'daily' && <DailyView />}
                        {view === 'weekly' && <WeeklyView />}
                        {view === 'monthly' && <MonthlyView />}
                        {view === 'summary' && <SummaryView />}
                        {view === 'edit' && <EditView />}
                    </div>
                </div>
            );
        }

        ReactDOM.render(<HealthTrackerApp />, document.getElementById('root'));
    </script>
</body>
</html>